
<div ng-if="$ctrl.purchaseCondition.sources.length == 1">

<div id="rewardsId" class="md-text-field">
	<div ng-if="$ctrl.isDCMUser">
		<label for="priority">Minimum purchase type</label>
		<div class="md-radio">
			<input type="radio" id="quantity" name="minpurchase" ng-model="$ctrl.qualuom" title="Quantity Purchase" value="Quantity" ng-change="$ctrl.setQualUOM($ctrl.qualuom);$ctrl.updatePrintLabel()" ng-disabled="$ctrl.preview"/>
			<label for="quantity"><span><span></span></span>Quantity purchase</label>
		</div>

		<div class="md-radio">
			<input type="radio" id="amount" name="minpurchase" ng-model="$ctrl.qualuom" title="Amount Spent" value="Amount" ng-change="$ctrl.setQualUOM($ctrl.qualuom);$ctrl.updatePrintLabel()" ng-disabled="$ctrl.preview"/>
			<label for="amount"><span><span></span></span>Amount spent</label>
		</div>
	</div>
	<div ng-if="$ctrl.isMFAUser">
		<label for="priority">Discount</label>
		<div class="md-radio">
			<input type="radio" id="quantity" name="minpurchase" ng-model="$ctrl.data.reward.type" title="Quantity Purchase" value="PERCNTOFF" ng-change="$ctrl.setRewardLabel();$ctrl.updatePrintLabel()" ng-disabled="$ctrl.preview"/>
			<label for="quantity"><span><span></span></span>Percent Off</label>
		</div>

		<div class="md-radio">
			<input type="radio" id="amount" name="minpurchase" ng-model="$ctrl.data.reward.type" title="Amount Spent" value="AMTOFF" ng-change="$ctrl.setRewardLabel();$ctrl.updatePrintLabel()" ng-disabled="$ctrl.preview"/>
			<label for="amount"><span><span></span></span>Amount Off</label>
		</div>
	</div>
</div>


<table class="table category__table">
		<tr class="category__table__row-nobottomborder" ng-hide="$ctrl.preview">
				<td colspan="3">
						<a href="" class="purchaseCondition__btn md-button" ng-click="$ctrl.addPurchaseCondition()">Add New Condition</a>
				</td>
		</tr>
		<tr class="odd">
				<td class="md-text-field">
						<label for="name">Minimum Purchase ({{$ctrl.qualuom}})</label>
				</td>
				<td class="md-text-field">
						<label for="name" ng-if="$ctrl.data.reward.type=='AMTOFF'">Amount Off</label>
						<label for="name" ng-if="$ctrl.data.reward.type=='PERCNTOFF'">Percentage Off</label>
				</td>
				<td class="md-text-field" ng-if="$ctrl.data.reward.type=='PERCNTOFF'">
						<label for="name" ng-show="$ctrl.data.purchaseConds.channels == 87">Maximum Discount Amount</label>
				</td>
				<td class="md-text-field"></td>
		</tr>

		<tr ng-repeat="item in $ctrl.data.reward.details track by $index" ng-class="{odd:($index % 2)}">
			 <td class="md-text-field">
						<input type="text" id="minamount" name="minamount_{{$index}}" ng-blur="$ctrl.validatePromotion()" ng-model="item.min" ng-required="$ctrl.preview" allow-pattern="(\d)" min = "1" ng-if="$ctrl.qualuom == 'Quantity'" ng-disabled="$ctrl.preview"/>
                        <input type="text" id="minamount" name="minamount_{{$index}}" ng-blur="$ctrl.validatePromotion()" ng-model="item.min" ng-required="$ctrl.preview" allow-pattern="^[\d.]+$" min = "1" ng-if="$ctrl.qualuom == 'Amount'" ng-disabled="$ctrl.preview"/>
						<span class='error-message' ng-show="$ctrl.promoform['minamount_' + $index].$invalid "></span> 
						<span class='error-message' ng-show="$ctrl.validationErrors.minimumThreshold[$index].isError && $ctrl.qualuom == 'Quantity'">Minimum purchase quantity {{$ctrl.validationErrors.minimumThreshold[$index].message}} </span>
						<span class='error-message' ng-show="$ctrl.validationErrors.minimumThreshold[$index].isError && $ctrl.qualuom == 'Amount'">Minumum purchase amount {{$ctrl.validationErrors.minimumThreshold[$index].message}} </span>
						
				</td>
				<td class="md-text-field">
						<input type="text" id="value" name="value_{{$index}}" ng-model="item.value" ng-required="$ctrl.preview" ng-blur="$ctrl.roundPercentage($index); $ctrl.validatePromotion()" allow-pattern="^[\d.]+$" ng-if="$ctrl.data.reward.type=='AMTOFF'" ng-disabled="$ctrl.preview"/>
                        <input type="text" id="value" name="value_{{$index}}" ng-model="item.value" ng-required="$ctrl.preview" ng-blur="$ctrl.roundPercentage($index); $ctrl.validatePromotion()" allow-pattern="^[\d.]+$" ng-if="$ctrl.data.reward.type=='PERCNTOFF'" class="tooltiphead" ng-disabled="$ctrl.preview"/>
							<span class='error-message' ng-show="$ctrl.promoform['value_' + $index].$invalid || $ctrl.preview">
									<span ng-show="$ctrl.promoform['value_' + $index].$error.min">
										Please enter a value above 0
									</span>
							</span>
							<span class='error-message' ng-show="$ctrl.validationErrors.rewards[$index].isError">{{$ctrl.validationErrors.rewards[$index].message}}	</span>					

							<tool-tipper-warning  ng-show="$ctrl.validationErrors.percentageWarning[$index].isError" show-tool-tip="true">	
								<p>
								{{$ctrl.validationErrors.percentageWarning[$index].message}}
								</p>		
							</tool-tipper-warning>
				</td>
				<td class="md-text-field" ng-if="$ctrl.data.reward.type=='PERCNTOFF'">

						<input type="text" id="maxval" name="maxval_{{$index}}" ng-model="item.maxAllowedVal" ng-blur="$ctrl.validatePromotion()"  ng-if="$ctrl.data.reward.type=='PERCNTOFF' || $ctrl.data.purchaseConds.channels == 87" allow-pattern="^[\d.]+$" ng-disabled="$ctrl.preview"  />
							<span class='error-message' ng-show="$ctrl.promoform['maxval_' + $index].$invalid ">
								<span ng-show="$ctrl.promoform['maxval_' + $index].$error.pattern">Please enter valid number</span>
							</span> 
							
				</td>
				<td class="md-text-field" ng-hide="$ctrl.preview"> <a ng-click="$ctrl.isDisabled || $ctrl.removePurchaseCondition($index)">Remove</a>
				</td>
		</tr>
</table>
</div>

<div ng-if="$ctrl.purchaseCondition.sources.length > 1">
    <div class="md-text-field" ng-if="$ctrl.promotype=='MultipleItemsPercentDiscount'">
      <label for="percentoff">Percentage discount off each combination</label>
      <input type="text" ng-model="$ctrl.data.reward.details[0].value" name="percentoff" ng-blur="$ctrl.validatePromotion()" ng-required="$ctrl.preview" required allow-pattern="(\d)" ng-disabled="$ctrl.preview"/>
		<span class='error-message' ng-show="$ctrl.validationErrors.rewards[0].isError">{{$ctrl.validationErrors.rewards[0].message}}	</span>
    </div>

    <div class="md-text-field" ng-if="$ctrl.promotype=='MultipleItemsValueDiscount'">
      <label for="amountoff">Amount off each combination</label>
      <input type="text" ng-model="$ctrl.data.reward.details[0].value" name="amountoff" ng-blur="$ctrl.validatePromotion()" ng-required="$ctrl.preview" required allow-pattern="^[\d.]+$" ng-disabled="$ctrl.preview" />
       <span class='error-message' ng-show="$ctrl.promoform.amountoff.$invalid ">
			<span ng-show="$ctrl.promoform.amountoff.$error.required">Please enter a valid amount</span>
	</span>
    </div>

    <div class="md-text-field">
      <label for="maxdiscount">Maximum discount amount</label>
      <input type="text" ng-model="$ctrl.data.reward.details[0].maxAllowedVal"   name="maxdiscount" allow-pattern="^[\d.]+$" ng-disabled="$ctrl.preview" />
    </div>
	
</div>